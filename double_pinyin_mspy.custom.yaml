# Rime schema
# encoding: utf-8
patch:
  switches:
    # - name: ascii_mode
    #   reset: 0
    #   states: [ ‰∏≠Êñá, Eng ]
    - name: emoji_suggestion
      reset: 1
      states: [ "Hah", "üòÑ" ]
    - name: full_shape
      states: [ Âçä, ÂÖ® ]
    - name: simplification
      reset: 1
      states: [ÁπÅ, ÁÆÄ]
    - name: ascii_punct
      reset: 1
      states: ["„ÄÇÔºå",". ," ]

  schema/dependencies:
    - luna_pinyin_assistant
  engine/filters:
#    - reverse_lookup_filter@double_assistant
    - simplifier
    - simplifier@emoji_suggestion
    - uniquifier
  engine/translators:
    - punct_translator
#    - script_translator@double_assistant
#    - reverse_lookup_translator
    - script_translator
    - table_translator@custom_phrase
    - lua_translator@date_time_translator

#  speller/alphabet: zyxwvutsrqponmlkjihgfedcba;
#  speller/initials: zyxwvutsrqponmlkjihgfedcba
  speller/algebra:
    - erase/^xx$/
#    - derive/^(\w+):\w+/$1/
#    - derive/^([aoe].*):/o$1:/
#    - xform/iu:/Q/
#    - xform/[iu]a:/W/
#    - xform/er:|[uv]an:/R/
#    - xform/[uv]e:/T/
#    - xform/v:|uai:/Y/
#    - xform/^sh/U/
#    - xform/^ch/I/
#    - xform/^zh/V/
#    - xform/uo:/O/
#    - xform/[uv]n:/P/
#    - xform/i?ong:/S/
#    - xform/[iu]ang:/D/
#    - xform/(.)en:/$1F/
#    - xform/(.)eng:/$1G/
#    - xform/(.)ang:/$1H/
#    - xform/ian:/M/
#    - xform/(.)an:/$1J/
#    - xform/iao:/C/
#    - xform/(.)ao:/$1K/
#    - xform/(.)ai:/$1L/
#    - xform/(.)ei:/$1Z/
#    - xform/ie:/X/
#    - xform/ui:/V/
#    - derive/T:/V/
#    - xform/(.)ou:/$1B/
#    - xform/in:/N/
#    - xform/ing:/;/
#    - xform/(.)([aoeuiv]):/$1$2/
#
    - xform/^([a-z;]+):\w+/$1/
    - xform/^([aoe].*)$/o$1/
    - xform/^([ae])(.*)$/$1$1$2/
    - xform/iu$/Q/
    - xform/[iu]a$/W/
    - xform/er$|[uv]an$/R/
    - xform/[uv]e$/T/
    - xform/v$|uai$/Y/
    - xform/^sh/U/
    - xform/^ch/I/
    - xform/^zh/V/
    - xform/uo$/O/
    - xform/[uv]n$/P/
    - xform/i?ong$/S/
    - xform/[iu]ang$/D/
    - xform/(.)en$/$1F/
    - xform/(.)eng$/$1G/
    - xform/(.)ang$/$1H/
    - xform/ian$/M/
    - xform/(.)an$/$1J/
    - xform/iao$/C/
    - xform/(.)ao$/$1K/
    - xform/(.)ai$/$1L/
    - xform/(.)ei$/$1Z/
    - xform/ie$/X/
    - xform/ui$/V/
    - derive/T$/V/
    - xform/(.)ou$/$1B/
    - xform/in$/N/
    - xform/ing$/;/
#    -
    - xlit/QWRTYUIOPSDFGHMJCKLZXVBN/qwrtyuiopsdfghmjcklzxvbn/

  custom_phrase:
    dictionary: ""
    user_dict: custom_phrase
    db_class: stabledb
    enable_completion: false
    enable_sentence: false
    initial_quality: 1

  emoji_suggestion:
    opencc_config: emoji.json
    option_name: emoji_suggestion
  translator:
    dictionary: luna_pinyin.extended
    user_dict: luna_pinyin
    db_class: tabledb
    spelling_hints: 2
#    comment_format:
#      - xform/\w+:(\w{2})/[$1]

  double_assistant:
    tag: double_assistant
#    tags: [double_assistant]
    dictionary: luna_pinyin_assistant
    enable_completion: true
    prefix: "`"
    suffix: "'"
    tips: „ÄîÂÖ®ÊãºÂèçÊü•„Äï
    comment_format:
      - xform/\w+:(\w{2})/[$1]
      - xform/\w+:(\w{1})/
#    prism: luna_pinyin_assistant

  __include: easy_en:/patch_double_pinyin_mspy
  easy_en/enable_sentence: false

  switches/@next:
    name: symbol_support
    reset: 1
    states: [ "Êó†Á¨¶", "Á¨¶" ]
  'engine/filters/@before 0':
    simplifier@symbol_support
  symbol_support:
    opencc_config: symbol.json
    option_name: symbol_support
    tips: all
  'punctuator/import_preset': symbols.custom
  'recognizer/patterns/punct': "^/([a-z]+|[0-9])$"
#  'recognizer/patterns/double_assistant': "^[a-z;]+:.*$"
#  'recognizer/patterns/double_assistant': "`[a-z;]*'?$"